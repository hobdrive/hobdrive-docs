# Методы расчета расхода и их калибровочные коэффициенты

Обычно сам автомобиль (и его ЭБУ) не сообщает сколько в каждый момент расходуется топлива. Хобдрайв использует показания групп датчиков для вычисления этого значения.

Конечно, вычисленное значение зависит от многих внешних условий, известных и не известных.

На разных автомобилях и ЭБУ используются различные методы подсчета расхода.

Это зависит от информации, которая поступает с ЭБУ. На некоторых авто может быть поддержка нескольких методов расчета.

Обзор внешнего вида диалогов настройки: https://vk.ru/video-45441804_456239020

## Алгоритмы расчета расхода топлива

Метод расчета расхода топлива выбирается на экране «Параметры Автомобиля»:

- Экраны -> Настройка

- Параметры автомобиля -> Метод расчета топлива

Экран предлагает настроить метод расчета и его параметры, и одновременно контролировать "Часовой расход".

В случае, если вы не уверены какой метод поддерживает ваш автомобиль, выбирайте последовательно начиная с первого и контролируйте показания «Часовой расход» (на этом же экране), но обязательно на холостом ходу!

Если "Часовой расход" показывает прочерк, то этот метод вам не подходит, если показания слишком завышенные или слишком заниженные - датчик покажет желтый/красный оттенок.


При настройке метода расхода топлива нет смысла смотреть на показатель "Расход топлива" в литрах на 100км. Этот показатель показывает правильные данные только когда автомобиль движется и набрана достаточная статистика.


В программе доступно несколько алгоритмов.

### MAF Датчик

Это вариант по умолчанию для большинства современных бензиновых автомобилей. Расчёт топлива в этом варианте ведётся по MAF (Mass Air Flow, ДМРВ, Датчик массового расхода воздуха). Это достаточно точный метод при условии что автомобиль исправен и подает стехиометрическую смесь.
Калибровочные коэффициенты для метода MAF:
– Коэффициент Топливо-воздушной смеси (AFR): Основная константа, означающая отношение количества топлива к количеству воздуха, попавшего в камеры сгорания.
Значение по умолчанию: «14.7»


Примеры для различных видов топлива (Воздух :Топливо) (AFR)
Неэтилированный бензин 14,7:1
Пропан (сжиженный газ) 15,5:1
Метан (сжатый газ) 17,2:1
Дизельное топливо 14,6:1
Метанол (метиловый спирт) 6,4:1
Этанол (этиловый спирт) 9,0:1


### MAP Датчик
Подсчёт расхода по MAP датчику (Manifold Absolute Pressure, Давление на впускном коллекторе). Альтернатива методу MAF.

На автомобилях без MAF используется MAP, температура впуска, объемная эффективность и обороты для определения расчетного значения потока воздуха.
Калибровочные коэффициенты для метода MAP:
– Коэффициент Топливо-воздушной смеси (AFR) — Аналогичен предыдущему описанию.
– Объем двигателя: Объем двигателя в литрах. Значение по умолчанию: «1.8» литра.
– Объемная эффективность (Volumetric Efficiency VE): Корректировочная константа для оценки эффективности использования попавшего в камеры сгорания двигателя. Значение по умолчанию: «95».


### Датчик Форсунки

Подсчёт расхода по доступному на некоторых автомобилях датчику Импульса Форсунки ("InjectorPulseWidth"). На протоколе OBD2 этот датчик недоступен.
Калибровочные коэффициенты для метода «Injector Sensor»
– Число цилиндров: Число цилиндров в двигателе. Значение по умолчанию: «4» цилиндра.
– Производительность форсунки: Количество топлива в мл/мин, впрыскиваемого одной форсункой. Исторически в хобдрайве указывается половина реальной производительности форсунки. Значение по умолчанию: «134.23» мл/мин (для реальной производительности 268 мл/мин).


### Датчик нагрузки на двигатель (дизель)

Подсчёт расхода топлива по датчику нагрузки на двигатель. Дает грубое приближение данных о расходе, используется только для дизельных автомобилей. Требует калибровки.
Калибровочные коэффициенты для метода «EngineLoad Sensor»
– Коэффициент расхода по нагрузке: Глобальный корректирующий коэффициент. Значение по умолчанию: «1»
– Кривая коэффициента по нагрузке: Используется для детальной подстройки расчёта расхода. Значение состоит из группы чисел, разделённых запятой. Каждое число означает коэффициент расхода при определённом RPM (от 0rpm до 10000rpm). Шаг rpm определяется количеством чисел в строке ( для десяти чисел, шаг RPM будет 1000).
Значение по умолчанию:
«0.025, 0.025, 0.10, 0.20, 0.3, 0.4, 0.3, 0.3, 0.3, 0.3»
Каждое число — множитель расхода при определённом RPM.
Например при RPM 2000 и датчике нагрузке 40% расход в час будет: 0.10*40 = 4 л\час

### Встроенный датчик часового расхода

Подсчёт расхода по внутреннему датчику часового расхода автомобиля, который высчитывает сам ЭБУ (присутствует, например,на автомобилях с ЭБУ Январь, Микас).
Калибровочные коэффициенты для метода «Встроенный датчик часового расхода» не применяются, так как по идее сам ЭБУ уже с максимальной точностью расчитал объем израсходованного топлива.

### Датчик циклового расхода (турбодизель)

Подсчёт расхода по внутреннему датчику циклового наполнения цилиндров топливом (CycleConsumption).

Калибровочные коэффициенты для метода «Датчик циклового расхода (турбодизель)»
– Число цилиндров: Число цилиндров в двигателе. Значение по умолчанию: «4» цилиндра
– Коэф. по цикловому расходу: Плотность ДТ.
Значение по умолчанию: 1.
Если ед.измерения циклового расхода в мм3/цикл, то коеф. равен 1.
Если измеряется в мг/цикл, то показатель плотности принято указывать (задан Ростехназдором) равным 0.84


## Внимание!

Разделителем целой и дробной части для нецелочисленных параметров является точка (например, 1.8 литра)


## Калибровка расхода и настройка коэффициентов

Самый простой способ подстройки коэффициентов и точной калибровки расхода — это сравнение показаний хобдрайв-а с реальным расходом по баку.
Для подсчёта реального расхода с бака, нужно вносить записи о заправках, с указанием точного количества залитых литров и одометра.
После двух заправок хобдрайв сможет посчитать реальный расход с бака. Вы сможете увидеть его на экране "События и заправки". Если данных достаточно и значения расхода адекватны, их можно использовать для калибровки.

Полученное значение нужно сравнить с показаниями расхода на экране «Бортовой компьютер» за относительно длинный интервал: "заправка", "месяц", "все время", и основываясь на расхождениях скорректировать ваш параметр (AFR, VE, либо "производительность форсунки" и т.д.).
Например, при реальном показании расхода в 12 л/100км хобдрайв показывает расход за месяц в 11 л/100км.
Это значит что при использовании метода MAF, вам нужно умножить текущий AFR на (12/11 = 1.09).

При использовании MAP вам нужно аналогично умножить текущий VE на 1.09.

При использовании Injector корректируется производительность форсунки (умножается на 1.09).
При использовании EngineLoad в простейшем случае вам надо аналогично менять «Коэффициент расхода по нагрузке».


Еще один быстрый способ подбора корректирующего коэффициента -

посмотреть расход в литрах/час на прогретом двигателе на холостых оборотах.

У многих бензиновых двигателей он должен быть равен половине объема.

Например, хобдрайв показывает 1 литр в час на холостых. Если у вас двигатель 1.6л, то

расход на холостых должен быть около 0.8 литра в час.

Новое значение VE = 95 * 0.8/1 = 76